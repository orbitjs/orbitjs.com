
<!DOCTYPE html>
<html lang="en">
    <head><meta name="generator" content="Hexo 3.8.0">
        <title>Updating data - Orbit.js</title>
        <meta charset="utf-8">
        <meta name="description" content="A framework for orchestrating access, transformation, and synchronization between data sources.">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <meta property="og:type" content="article">
        <meta property="og:title" content="Updating data - Orbit.js">
        <meta property="og:description" content="A framework for orchestrating access, transformation, and synchronization between data sources.">
        <meta property="og:image" content="http://orbitjs.com/images/logo.png">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Updating data - Orbit.js">
        <meta name="twitter:description" content="A framework for orchestrating access, transformation, and synchronization between data sources.">
        <meta name="twitter:image" content="http://orbitjs.com/images/logo.png">

        <!-- ****** faviconit.com favicons ****** -->
      	<link rel="shortcut icon" href="/favicon.ico">
      	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
      	<link rel="icon" type="image/png" sizes="196x196" href="/favicon-192.png">
      	<link rel="icon" type="image/png" sizes="160x160" href="/favicon-160.png">
      	<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96.png">
      	<link rel="icon" type="image/png" sizes="64x64" href="/favicon-64.png">
      	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
      	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
      	<link rel="apple-touch-icon" href="/favicon-57.png">
      	<link rel="apple-touch-icon" sizes="114x114" href="/favicon-114.png">
      	<link rel="apple-touch-icon" sizes="72x72" href="/favicon-72.png">
      	<link rel="apple-touch-icon" sizes="144x144" href="/favicon-144.png">
      	<link rel="apple-touch-icon" sizes="60x60" href="/favicon-60.png">
      	<link rel="apple-touch-icon" sizes="120x120" href="/favicon-120.png">
      	<link rel="apple-touch-icon" sizes="76x76" href="/favicon-76.png">
      	<link rel="apple-touch-icon" sizes="152x152" href="/favicon-152.png">
      	<link rel="apple-touch-icon" sizes="180x180" href="/favicon-180.png">
      	<meta name="msapplication-TileColor" content="#FFFFFF">
      	<meta name="msapplication-TileImage" content="/favicon-144.png">
      	<meta name="msapplication-config" content="/browserconfig.xml">
      	<!-- ****** faviconit.com favicons ****** -->
        <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        <!-- main page styles -->
        <link rel="stylesheet" href="/css/page.css">

        <!-- this needs to be loaded before guide's inline scripts -->
        <script>window.PAGE_TYPE = "guide"</script>

        <!-- ga -->
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-1632329-6', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="docs">        <div id="mobile-bar">
            <a class="menu-button"></a>
            <a class="logo" href="/"></a>
        </div>
        <div id="header">
  <a id="logo" href="/">
    <img src="/images/orbitjs.png" alt="Orbit.js">
  </a>
  <ul id="nav">
    <li><a href="/v0.15/guide/" class="nav-link current">Guide</a></li>
<li><a href="/sponsor/" class="nav-link">Sponsor</a></li>
<li><a href="https://github.com/orbitjs/orbit" class="nav-link">GitHub</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li class="nav-gitter"><a href="https://gitter.im/orbitjs/orbit.js" class="nav-link" target="_blank">Chat</a></li>
    <li class="nav-twitter"><a href="https://twitter.com/orbitjs" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>


  </ul>
</div>

        
            <div id="main" class="fix-sidebar">
                
                    
    <div class="sidebar">
    <ul class="main-menu">
        <li><a href="/v0.15/guide/" class="nav-link current">Guide</a></li>
<li><a href="/sponsor/" class="nav-link">Sponsor</a></li>
<li><a href="https://github.com/orbitjs/orbit" class="nav-link">GitHub</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li class="nav-gitter"><a href="https://gitter.im/orbitjs/orbit.js" class="nav-link" target="_blank">Chat</a></li>
    <li class="nav-twitter"><a href="https://twitter.com/orbitjs" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>


    </ul>
    <div class="list">
        <h2>
            Guide
            <select class="version-select">
                
                <option value="0.15" selected>v0.15</option>
                
            </select>
        </h2>
        <div id="donate" style="margin-bottom: 20px">
            <img src="/images/paypal.png">
            <a href="/sponsor">Sponsor Orbit.js</a>
        </div>
        <ul class="menu-root">
            
            
            
                
                <li>
                    <a href="/v0.15/guide/index.html" class="sidebar-link">Introduction</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/packages.html" class="sidebar-link">Packages</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/getting-started.html" class="sidebar-link">Getting started</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/modeling-data.html" class="sidebar-link">Modeling data</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/data-sources.html" class="sidebar-link">Data sources</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/updating-data.html" class="sidebar-link current">Updating data</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/querying-data.html" class="sidebar-link">Querying data</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/task-processing.html" class="sidebar-link">Task processing</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/data-flows.html" class="sidebar-link">Data flows</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/coordination.html" class="sidebar-link">Coordination strategies</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/data-stores.html" class="sidebar-link">Data stores</a>
                </li>
            
                
                <li>
                    <a href="/v0.15/guide/license.html" class="sidebar-link">License</a>
                </li>
            
        </ul>
    </div>
</div>


<div class="content guide with-sidebar updating-data-guide">
  
    <h1>Updating data</h1>
  
  <p>Data in a source can be updated by applying a transform, which consists of one
or more operations. Transforms must be applied atomically—all operations
succeed or fail together.</p>
<h2 id="Operations"><a href="#Operations" class="headerlink" title="Operations"></a>Operations</h2><p>Operations each represent a single change to a record or relationship (e.g.
adding a record, updating a field, deleting a relationship, etc.).</p>
<p>The <code>Operation</code> interface requires one member:</p>
<ul>
<li><code>op</code> - a string identifying the type of operation</li>
</ul>
<p>The other members of an <code>Operation</code> are specific to the <code>op</code>.</p>
<p>The following standard operations are defined in <code>@orbit/data</code>:</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> Operation &#123;</span><br><span class="line">  op: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> AddRecordOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'addRecord'</span>;</span><br><span class="line">  record: Record;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ReplaceRecordOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'replaceRecord'</span>;</span><br><span class="line">  record: Record;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> RemoveRecordOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'removeRecord'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ReplaceKeyOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'replaceKey'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">  key: <span class="built_in">string</span>;</span><br><span class="line">  value: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ReplaceAttributeOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'replaceAttribute'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">  attribute: <span class="built_in">string</span>;</span><br><span class="line">  value: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> AddToRelatedRecordsOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'addToRelatedRecords'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">  relationship: <span class="built_in">string</span>;</span><br><span class="line">  relatedRecord: RecordIdentity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> RemoveFromRelatedRecordsOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'removeFromRelatedRecords'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">  relationship: <span class="built_in">string</span>;</span><br><span class="line">  relatedRecord: RecordIdentity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ReplaceRelatedRecordsOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'replaceRelatedRecords'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">  relationship: <span class="built_in">string</span>;</span><br><span class="line">  relatedRecords: RecordIdentity[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ReplaceRelatedRecordOperation <span class="keyword">extends</span> Operation &#123;</span><br><span class="line">  op: <span class="string">'replaceRelatedRecord'</span>;</span><br><span class="line">  record: RecordIdentity;</span><br><span class="line">  relationship: <span class="built_in">string</span>;</span><br><span class="line">  relatedRecord: RecordIdentity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Transforms"><a href="#Transforms" class="headerlink" title="Transforms"></a>Transforms</h2><p>The <code>Transform</code> interface has the following members:</p>
<ul>
<li><code>id</code> - a string that uniquely identifies the transform</li>
<li><code>operations</code> - an array of <code>Operation</code> objects</li>
<li><code>options</code> - an optional object that represents options that can influence how
a transform is processed</li>
</ul>
<p>Although transforms can be created “manually”, you’ll probably find it easier
to use a builder function that returns a transform.</p>
<p>To use a transform builder, pass a function into a source’s method that expects
a transform, such as <code>update</code> or <code>push</code>. A <code>TranformBuilder</code> that’s compatible
with the source should be applied as an argument. You can then use this builder
to create one or more operations.</p>
<p>For instance, here’s how you might update a store with a single record:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> earth = &#123;</span><br><span class="line">  type: <span class="string">'planet'</span>,</span><br><span class="line">  id: <span class="string">'earth'</span>,</span><br><span class="line">  attributes: &#123;</span><br><span class="line">    name: <span class="string">'Earth'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.addRecord(earth));</span><br></pre></td></tr></table></figure>
<p>To perform more than one operation in a single transform, just return an array
of operations:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> [t.addRecord(earth), t.addRecord(jupiter)]);</span><br></pre></td></tr></table></figure>
<h3 id="Standard-transforms"><a href="#Standard-transforms" class="headerlink" title="Standard transforms"></a>Standard transforms</h3><p>You can use the standard <code>@orbit/data</code> transform builder as follows:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Adding a new record</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.addRecord(&#123;</span><br><span class="line">  type: <span class="string">'planet'</span>,</span><br><span class="line">  id: <span class="string">'earth'</span>,</span><br><span class="line">  attributes: &#123;</span><br><span class="line">    name: <span class="string">'Earth'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replacing an entire record</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.replaceRecord(&#123;</span><br><span class="line">  type: <span class="string">'planet'</span>,</span><br><span class="line">  id: <span class="string">'earth'</span>,</span><br><span class="line">  attributes: &#123;</span><br><span class="line">    name: <span class="string">'Earth'</span>,</span><br><span class="line">    classification: <span class="string">'terrestrial'</span>,</span><br><span class="line">    atmosphere: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Removing a record</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.removeRecord(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'earth'</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replacing a key</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.replaceKey(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'earth'</span> &#125;,</span><br><span class="line">  <span class="string">'remoteId'</span>,</span><br><span class="line">  <span class="string">'abc123'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replacing an attribute</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.replaceAttribute(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'earth'</span> &#125;,</span><br><span class="line">  <span class="string">'classification'</span>,</span><br><span class="line">  <span class="string">'gaseous'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Adding a member to a to-many relationship</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.addToRelatedRecords(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'jupiter'</span> &#125;,</span><br><span class="line">  <span class="string">'moons'</span>,</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'moon'</span>, <span class="attr">id</span>: <span class="string">'io'</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Removing a member from a to-many relationship</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.removeFromRelatedRecords(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'jupiter'</span> &#125;,</span><br><span class="line">  <span class="string">'moons'</span>,</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'moon'</span>, <span class="attr">id</span>: <span class="string">'io'</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replacing every member of a to-many relationship</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.replaceRelatedRecords(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'jupiter'</span> &#125;,</span><br><span class="line">  <span class="string">'moons'</span>,</span><br><span class="line">  [&#123; <span class="attr">type</span>: <span class="string">'moon'</span>, <span class="attr">id</span>: <span class="string">'io'</span> &#125;, &#123; <span class="attr">type</span>: <span class="string">'moon'</span>, <span class="attr">id</span>: <span class="string">'europa'</span> &#125;]));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replacing a to-one relationship</span></span><br><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.replaceRelatedRecord(</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'planet'</span>, <span class="attr">id</span>: <span class="string">'jupiter'</span> &#125;,</span><br><span class="line">  <span class="string">'solarSystem'</span>,</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">'solarSystem'</span>, <span class="attr">id</span>: <span class="string">'ourSolarSystem'</span> &#125;));</span><br></pre></td></tr></table></figure>
<h3 id="Transform-options"><a href="#Transform-options" class="headerlink" title="Transform options"></a>Transform options</h3><p>Options can be added to transforms to provide processing instructions to
particular sources and to include metadata about transforms.</p>
<p>For example, the following transform is given a <code>label</code> and contains
instructions for the source named <code>remote</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">store.update(<span class="function"><span class="params">t</span> =&gt;</span> t.replaceRecord(&#123;</span><br><span class="line">  type: <span class="string">'planet'</span>,</span><br><span class="line">  id: <span class="string">'earth'</span>,</span><br><span class="line">  attributes: &#123;</span><br><span class="line">    name: <span class="string">'Earth'</span>,</span><br><span class="line">    classification: <span class="string">'terrestrial'</span>,</span><br><span class="line">    atmosphere: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;), &#123;</span><br><span class="line">  label: <span class="string">'Update planet Earth'</span>,</span><br><span class="line">  sources: &#123;</span><br><span class="line">    remote: &#123;</span><br><span class="line">      timeout: <span class="number">100000</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>A <code>label</code> can be useful for providing an understanding of actions that have been
queued for processing.</p>
<p>The <code>sources: { ${sourceName}: sourceSpecificOptions }</code> pattern is used to pass
options that only a particular source will understand when processing a
transform. In this instance, we’re telling our remote source to use a custom
timeout when performing this particular update.</p>

  
    <div class="guide-links">
      
        <span>← <a href="/v0.15/guide/data-sources.html">Data sources</a></span>
      
      
        <span style="float:right"><a href="/v0.15/guide/querying-data.html">Querying data</a> →</span>
      
    </div>
  
  <div class="footer">
    Want to correct or improve this documentation?
    <a href="https://github.com/orbitjs/orbitjs-site/blob/master/src/v0.15/guide/updating-data.md" target="_blank">
      Edit this page on Github!
    </a>
  </div>
</div>

                
            </div>
            <script src="/js/smooth-scroll.min.js"></script>
        

        <!-- main custom script for sidebars, version selects etc. -->
        <script src="/js/common.js"></script>

        <!-- fastclick -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
        <script>
        document.addEventListener('DOMContentLoaded', function() {
          FastClick.attach(document.body)
        }, false)
        </script>
    </body>
</html>
